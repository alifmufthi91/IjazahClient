(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c4c50"],{"3bf1":function(t,n,e){"use strict";e.r(n),e.d(n,"GET_ACCOUNTS",(function(){return d}));var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("CRow",[e("CCol",{attrs:{col:"12",xl:"12"}},[e("CCard",[e("CCardHeader",[t._v("Info Civitas")]),e("CCardBody",[e("CDataTable",{attrs:{hover:"",items:t.filteredItems,fields:t.fields,"items-per-page":5,"active-page":t.activePage,pagination:{doubleArrows:!1,align:"center"},sorter:"",columnFilter:""},on:{"page-change":t.pageChange},scopedSlots:t._u([{key:"id-filter",fn:function(){return[e("input",{staticClass:"form-control form-control-sm",domProps:{value:t.filterNip},on:{change:t.setFilterId}})]},proxy:!0},{key:"id",fn:function(n){return[e("td",[t._v(t._s(t.hexToString(n.item.id)))])]}},{key:"name-filter",fn:function(){return[e("input",{staticClass:"form-control form-control-sm",domProps:{value:t.filterNama},on:{change:t.setFilterNama}})]},proxy:!0},{key:"name",fn:function(n){return[e("td",[t._v(t._s(t.hexToString(n.item.name)))])]}},{key:"action",fn:function(n){return[e("td",[e("CCol",{staticClass:"mb-3 mb-xl-0"},[e("CButtonGroup",[e("CButton",{attrs:{color:"primary",size:"sm"},on:{click:function(e){return t.detailClicked(n.item)}}},[t._v("Detail")]),e("CButton",{attrs:{color:"info",size:"sm"}},[t._v("Edit")]),n.item.linkedAccount?t._e():e("CButton",{attrs:{color:"success",size:"sm"},on:{click:function(e){return t.openLinkModal(n.item)}}},[t._v("Link Akun")]),n.item.linkedAccount?e("CButton",{attrs:{color:"secondary",size:"sm"},on:{click:function(e){return t.openUnlinkModal(n.item)}}},[t._v("Unlink Akun")]):t._e()],1)],1)],1)]}}])})],1)],1)],1),e("CModal",{attrs:{show:t.linkModal,"no-close-on-backdrop":!0,centered:!0,title:"Link Akun",md:"8",color:"success"},on:{"update:show":function(n){t.linkModal=n}},scopedSlots:t._u([{key:"header",fn:function(){return[e("h6",{staticClass:"modal-title"},[t._v("Link Akun")]),e("CButtonClose",{staticClass:"text-white",on:{click:function(n){t.linkModal=!1}}})]},proxy:!0},{key:"footer",fn:function(){return[e("CButton",{attrs:{color:"danger"},on:{click:function(n){return t.confirmLink(!1)}}},[t._v("Kembali")]),e("CButton",{attrs:{color:"success"},on:{click:function(n){return t.confirmLink(!0)}}},[t._v("Konfirmasi")])]},proxy:!0}])},[e("CRow",[e("CCol",[e("CInput",{attrs:{label:"Name",horizontal:"",readonly:"",value:t.hexToString(t.selectedCivitas.name)}}),e("CInput",{attrs:{label:"NIP",horizontal:"",readonly:"",value:t.hexToString(t.selectedCivitas.id)}}),e("CSelect",{attrs:{label:"Akun",horizontal:"",options:t.accountOptions,value:t.selectedCivitas.address,placeholder:"Pilih Akun"},on:{"update:value":function(n){return t.$set(t.selectedCivitas,"address",n)}}})],1)],1)],1),e("CModal",{attrs:{show:t.unlinkModal,"no-close-on-backdrop":!0,centered:!0,title:"Unlink Akun",md:"8",color:"success"},on:{"update:show":function(n){t.unlinkModal=n}},scopedSlots:t._u([{key:"header",fn:function(){return[e("h6",{staticClass:"modal-title"},[t._v("Unlink Akun")]),e("CButtonClose",{staticClass:"text-white",on:{click:function(n){t.unlinkModal=!1}}})]},proxy:!0},{key:"footer",fn:function(){return[e("CButton",{attrs:{color:"danger"},on:{click:function(n){return t.confirmUnlink(!1)}}},[t._v("Kembali")]),e("CButton",{attrs:{color:"success"},on:{click:function(n){return t.confirmUnlink(!0)}}},[t._v("Konfirmasi")])]},proxy:!0}])},[e("CRow",[e("CCol",[e("CInput",{attrs:{label:"Name",horizontal:"",readonly:"",value:t.hexToString(t.selectedCivitas.name)}}),e("CInput",{attrs:{label:"NIP",horizontal:"",readonly:"",value:t.hexToString(t.selectedCivitas.id)}})],1)],1)],1)],1)},o=[],r=e("9530"),a=e.n(r),s=e("3f55");function l(){var t=u(["\n      query {\n        civitas {\n          id\n          name\n          linkedAccount{\n            id\n          }\n        }\n      }\n    "]);return l=function(){return t},t}function c(){var t=u(["\n  query accounts($nomorInduk: Bytes!) {\n    accounts(where: { nomorInduk: $nomorInduk }) {\n      id\n      name\n    }\n  }\n"]);return c=function(){return t},t}function u(t,n){return n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}}))}var d=a()(c()),f={name:"InfoCivitas",apollo:{civitas:a()(l())},data:function(){return{fields:[{key:"id",label:"NIP"},{key:"name"},{key:"action",label:"Aksi",sorter:!1,filter:!1}],activePage:1,selectedCivitas:{id:String(),name:String(),address:String()},linkModal:!1,unlinkModal:!1,accountOptions:[],filterNip:"",filterNama:""}},watch:{$route:{immediate:!0,handler:function(t){t.query&&t.query.page&&(this.activePage=Number(t.query.page))}}},mounted:function(){this.$apollo.queries.civitas.refetch()},computed:{computedItems:function(){return this.civitas},filteredItems:function(){var t=this;return this.civitas?this.computedItems.filter((function(n){if(!t.filterNip&&!t.filterNama)return!0;var e=n.id,i=n.name;return web3.utils.hexToUtf8(e).toLowerCase().includes(t.filterNip.toLowerCase())&&web3.utils.hexToUtf8(i).toLowerCase().includes(t.filterNama.toLowerCase())})):[]}},methods:{pageChange:function(t){this.$router.push({query:{page:t}})},detailClicked:function(t){this.$router.push({path:"civitas/detail/"+"".concat(t.id)})},setFilterId:function(t){this.filterNip=t.target.value},setFilterNama:function(t){this.filterNama=t.target.value},hexToString:function(t){if(web3.utils.isHexStrict(t))return web3.utils.hexToUtf8(t)},linkCivitas:function(){var t=this.selectedCivitas;web3.eth.getAccounts().then((function(n){s["a"].methods.linkCivitasAccount(t.address,t.id).send({from:n[0]}).on("error",(function(t,n){console.log(t)})).on("transactionHash",(function(t){console.log(t)}))}))},unlinkCivitas:function(){var t=this.selectedCivitas;web3.eth.getAccounts().then((function(n){s["a"].methods.unlinkCivitasAccount(t.linkedAccount.id).send({from:n[0]}).on("error",(function(t,n){console.log(t)})).on("transactionHash",(function(t){console.log(t)}))}))},openLinkModal:function(t){this.linkModal=!0,this.selectedCivitas=t,this.getAccountById()},openUnlinkModal:function(t){this.unlinkModal=!0,this.selectedCivitas=t},confirmLink:function(t){this.linkModal=!1,t&&this.linkCivitas()},confirmUnlink:function(t){this.unlinkModal=!1,t&&this.unlinkCivitas()},getAccountById:function(){var t=this;this.accountOptions=[],this.$apollo.query({query:d,variables:{nomorInduk:this.selectedCivitas.id}}).then((function(n){n.data.accounts.forEach((function(n){t.accountOptions.push({label:web3.utils.hexToUtf8(n.name)+" ("+n.id+")",value:n.id})}))}))}}},h=f,m=e("2877"),k=Object(m["a"])(h,i,o,!1,null,null,null);n["default"]=k.exports}}]);
//# sourceMappingURL=chunk-2d0c4c50.d9efbb41.js.map