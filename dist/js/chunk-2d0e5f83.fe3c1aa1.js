(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e5f83"],{"976e":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CRow",[o("CCol",{attrs:{col:"12",xl:"12"}},[o("CCard",[o("CCardHeader",[e._v(e._s(e.$options.name))]),o("CCardBody",[o("CDataTable",{attrs:{hover:"",items:e.filteredItems,fields:e.fields,"items-per-page":5,"active-page":e.activePage,pagination:{doubleArrows:!1,align:"center"},sorter:"",columnFilter:""},on:{"page-change":e.pageChange},scopedSlots:e._u([{key:"id-filter",fn:function(){return[o("input",{staticClass:"form-control form-control-sm",domProps:{value:e.filterAlamat},on:{change:e.setFilterAlamat}})]},proxy:!0},{key:"name-filter",fn:function(){return[o("input",{staticClass:"form-control form-control-sm",domProps:{value:e.filterNama},on:{change:e.setFilterNama}})]},proxy:!0},{key:"name",fn:function(t){return[o("td",{staticClass:"font-weight-bold"},[e._v(e._s(e.hexToString(t.item.name)))])]}},{key:"role-filter",fn:function(){return[o("input",{staticClass:"form-control form-control-sm",domProps:{value:e.filterRole},on:{change:e.setFilterRole}})]},proxy:!0},{key:"role",fn:function(t){return[o("td",[e._v(e._s(e.hexToString(t.item.role)))])]}},{key:"nomorInduk-filter",fn:function(){return[o("input",{staticClass:"form-control form-control-sm",domProps:{value:e.filterNomorId},on:{change:e.setFilterNI}})]},proxy:!0},{key:"nomorInduk",fn:function(t){return[o("td",[e._v(e._s(e.hexToString(t.item.nomorInduk)))])]}},{key:"verified",fn:function(t){return[o("td",[o("CBadge",{attrs:{color:e.getBadge(t.item.verified)}},[e._v(e._s(e.getVerified(t.item.verified)))])],1)]}},{key:"action",fn:function(t){return[o("td",[o("CCol",{staticClass:"mb-3 mb-xl-0 text-center"},[o("CButtonGroup",[o("CButton",{attrs:{color:"success",size:"sm"},on:{click:function(o){return e.openConfirmModal(t.item)}}},[e._v("Terima")]),o("CButton",{attrs:{color:"danger",size:"sm"}},[e._v("Tolak")])],1)],1)],1)]}}])})],1)],1)],1),o("CModal",{attrs:{show:e.confirmModal,"no-close-on-backdrop":!0,centered:!0,title:"Konfirmasi",md:"8",color:"success"},on:{"update:show":function(t){e.confirmModal=t}},scopedSlots:e._u([{key:"header",fn:function(){return[o("h6",{staticClass:"modal-title"},[e._v("Konfirmasi")]),o("CButtonClose",{staticClass:"text-white",on:{click:function(t){e.confirmModal=!1}}})]},proxy:!0},{key:"footer",fn:function(){return[o("CButton",{attrs:{color:"danger"},on:{click:function(t){return e.confirmVerify(!1)}}},[e._v("Kembali")]),o("CButton",{attrs:{color:"success"},on:{click:function(t){return e.confirmVerify(!0)}}},[e._v("Konfirmasi")])]},proxy:!0}])},[o("CRow",[o("CCol",[o("CInput",{attrs:{label:"Alamat",horizontal:"",readonly:"",value:e.selectedUser.id}}),o("CInput",{attrs:{label:"Name",horizontal:"",readonly:"",value:e.hexToString(e.selectedUser.name)}}),o("CInput",{attrs:{label:"Status",horizontal:"",readonly:"",value:e.getVerified(e.selectedUser.verified)}}),o("CInput",{attrs:{label:"No. Induk",horizontal:"",readonly:"",value:e.hexToString(e.selectedUser.nomorInduk)}}),o("CInput",{attrs:{label:"Role Diminta",horizontal:"",readonly:"",value:e.hexToString(e.selectedUser.role)}}),o("CSelect",{attrs:{label:"Role",horizontal:"",options:e.selectOptions,value:e.selectedUser.givenRole,placeholder:"Please select"},on:{"update:value":function(t){return e.$set(e.selectedUser,"givenRole",t)}}})],1)],1)],1)],1)},r=[],i=o("9530"),a=o.n(i),l=o("4855");function s(){var e=u(["\n      query {\n        accounts(where: { verified: false, isDeleted: false }, orderBy: name) {\n          id\n          name\n          nomorInduk\n          verified\n          role\n        }\n      }\n    "]);return s=function(){return e},e}function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c={name:"RoleRequest",apollo:{accounts:a()(s())},data:function(){return{fields:[{key:"name",label:"Name"},{key:"id",label:"Alamat"},{key:"role"},{key:"nomorInduk",label:"Nomor Induk"},{key:"verified",label:"Verified",filter:!1},{key:"action",label:"Aksi",sorter:!1,filter:!1}],activePage:1,filterNama:"",filterAlamat:"",filterRole:"",filterNomorId:"",confirmModal:!1,selectedUser:{id:String(),name:String(),verified:null,role:String(),givenRole:String()},verify:{mahasiswa:l["a"].methods.verifyMahasiswa,dikti:l["a"].methods.verifyDIKTI,civitas:l["a"].methods.verifyCivitas},selectOptions:[{value:"mahasiswa",label:"Mahasiswa"},{value:"admin",label:"Admin"},{value:"dosen",label:"Dosen"},{value:"dikti",label:"Dikti"},{value:"pd2",label:"PD II"},{value:"rektor",label:"Rektor"},{value:"kajur",label:"Kepala Jurusan"}]}},watch:{$route:{immediate:!0,handler:function(e){e.query&&e.query.page&&(this.activePage=Number(e.query.page))}}},mounted:function(){this.$apollo.queries.accounts.refetch()},computed:{jenisVerify:function(){switch(this.selectedUser.givenRole){case"mahasiswa":return"mahasiswa";case"dikti":return"dikti";default:return"civitas"}},computedItems:function(){return this.accounts},filteredItems:function(){var e=this;return this.accounts?this.computedItems.filter((function(t){if(!e.filterNama&&!e.filterAlamat&&!e.filterRole&&!e.filterNomorId)return!0;var o=t.name,n=t.id,r=t.role,i=t.nomorInduk;return web3.utils.hexToUtf8(o).toLowerCase().includes(e.filterNama.toLowerCase())&&n.toLowerCase().includes(e.filterAlamat.toLowerCase())&&web3.utils.hexToUtf8(r).toLowerCase().includes(e.filterRole.toLowerCase())&&web3.utils.hexToUtf8(i).toLowerCase().includes(e.filterNomorId.toLowerCase())})):[]}},methods:{getBadge:function(e){return e?"success":"warning"},getVerified:function(e){return e?"Terverifikasi":"Belum Diverifikasi"},setFilterNama:function(e){this.filterNama=e.target.value},setFilterAlamat:function(e){this.filterAlamat=e.target.value},setFilterRole:function(e){this.filterRole=e.target.value},setFilterNI:function(e){this.filterNomorId=e.target.value},pageChange:function(e){this.$router.push({query:{page:e}})},detailClicked:function(e){this.$router.push({path:"account/"+"".concat(e.id)})},confirmVerify:function(e){this.confirmModal=!1,e&&this.verifyAccount()},verifyAccount:function(){var e=this;web3.eth.getAccounts().then((function(t){"mahasiswa"==e.selectedUser.givenRole?e.verify[e.jenisVerify](e.selectedUser.id,web3.utils.utf8ToHex(web3.utils.hexToUtf8(e.selectedUser.nomorInduk)),t[0]).send({from:t[0]}).on("error",(function(e,t){console.log(e)})).on("transactionHash",(function(e){console.log(e)})):"dikti"==e.selectedUser.givenRole?e.verify[e.jenisVerify](e.selectedUser.id).send({from:t[0]}).on("error",(function(e,t){console.log(e)})).on("transactionHash",(function(e){console.log(e)})):e.verify[e.jenisVerify](e.selectedUser.id,web3.utils.utf8ToHex(web3.utils.hexToUtf8(e.selectedUser.nomorInduk)),web3.utils.utf8ToHex(e.selectedUser.givenRole),t[0]).send({from:t[0]}).on("error",(function(e,t){console.log(e)})).on("transactionHash",(function(e){console.log(e)}))}))},openConfirmModal:function(e){this.confirmModal=!0,this.selectedUser=e},hexToString:function(e){if(web3.utils.isHexStrict(e))return web3.utils.hexToUtf8(e)}}},f=c,d=o("2877"),m=Object(d["a"])(f,n,r,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0e5f83.fe3c1aa1.js.map