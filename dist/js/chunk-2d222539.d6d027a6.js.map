{"version":3,"sources":["webpack:///./src/views/mahasiswa/InfoMahasiswa.vue?9d68","webpack:///src/views/mahasiswa/InfoMahasiswa.vue","webpack:///./src/views/mahasiswa/InfoMahasiswa.vue?c17a","webpack:///./src/views/mahasiswa/InfoMahasiswa.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","dataContract","fields","dataSubgraph","dataIpfs","staticClass","previewImage","_e","staticStyle","riwayatStudis","studiFields","scopedSlots","_u","key","fn","data","_s","item","ampu","hexToUtf8","namaMatkul","nilai","unixToDate","timeUpdated","on","goBack","staticRenderFns","host","port","protocol","name","beforeRouteEnter","next","vm","usersOpened","from","fullPath","mahasiswaData","nim","String","ipfsHash","mahasiswaIpfs","computed","mhsDataSubgraph","mhsDetails","map","mhsDataOnChain","mhs","mhsDataIpfs","mhsIpfs","visibleDataSubgraph","filter","param","value","Date","web3","utils","isHexStrict","id","methods","$router","go","hex","date","toString","beforeMount","eth","getAccounts","then","CivitasHelper","component"],"mappings":"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","file":"js/chunk-2d222539.d6d027a6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('CCard',[_c('CCardHeader',[_vm._v(\"Informasi Mahasiswa\")]),_c('CCardBody',[_c('h5',[_vm._v(\"Data On-Chain\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.dataContract,\"fields\":_vm.fields}}),_c('h5',[_vm._v(\"Data Off-Chain (Subgraph)\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.dataSubgraph,\"fields\":_vm.fields}}),_c('h5',[_vm._v(\"Data Off-Chain (IPFS)\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.dataIpfs,\"fields\":_vm.fields}}),_c('CRow',{staticClass:\"justify-content-center\"},[_c('CCol',{attrs:{\"sm\":\"3\"}},[_c('CCard',[_c('CCardBody',[(!_vm.previewImage)?_c('div',[_c('CProgress',{staticClass:\"mt-1\",staticStyle:{\"height\":\"20px\"},attrs:{\"color\":\"success\",\"value\":100,\"animated\":\"\"}})],1):_vm._e(),(_vm.previewImage)?_c('div',[_c('img',{staticClass:\"d-block w-100 h-100 img-fluid\",attrs:{\"src\":_vm.previewImage}})]):_vm._e()])],1)],1)],1),_c('h5',[_vm._v(\"Riwayat Studi (Subgraph)\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.riwayatStudis,\"fields\":_vm.studiFields},scopedSlots:_vm._u([{key:\"mataKuliah\",fn:function(data){return [_c('td',[_vm._v(_vm._s(data.item.ampu?_vm.hexToUtf8(data.item.ampu.namaMatkul):''))])]}},{key:\"nilai\",fn:function(data){return [_c('td',[_vm._v(_vm._s(_vm.hexToUtf8(data.item.nilai)))])]}},{key:\"timeUpdated\",fn:function(data){return [_c('td',[_vm._v(_vm._s(_vm.unixToDate(data.item.timeUpdated)))])]}}])})],1),_c('CCardFooter',[_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.goBack}},[_vm._v(\"Back\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <CRow>\r\n    <CCol col=\"12\">\r\n      <CCard>\r\n        <CCardHeader>Informasi Mahasiswa</CCardHeader>\r\n        <CCardBody>\r\n          <h5>Data On-Chain</h5>\r\n          <CDataTable striped small fixed :items=\"dataContract\" :fields=\"fields\" />\r\n          <h5>Data Off-Chain (Subgraph)</h5>\r\n          <CDataTable striped small fixed :items=\"dataSubgraph\" :fields=\"fields\" />\r\n          <h5>Data Off-Chain (IPFS)</h5>\r\n          <CDataTable striped small fixed :items=\"dataIpfs\" :fields=\"fields\" />\r\n          <CRow class=\"justify-content-center\">\r\n            <CCol sm=\"3\">\r\n              <CCard>\r\n                <CCardBody>\r\n                  <div v-if=\"!previewImage\">\r\n                    <CProgress\r\n                      color=\"success\"\r\n                      :value=\"100\"\r\n                      animated\r\n                      style=\"height:20px;\"\r\n                      class=\"mt-1\"\r\n                    />\r\n                  </div>\r\n                  <div v-if=\"previewImage\">\r\n                    <img class=\"d-block w-100 h-100 img-fluid\" :src=\"previewImage\" />\r\n                  </div>\r\n                </CCardBody>\r\n              </CCard>\r\n            </CCol>\r\n          </CRow>\r\n          <h5>Riwayat Studi (Subgraph)</h5>\r\n          <CDataTable striped small fixed :items=\"riwayatStudis\" :fields=\"studiFields\">\r\n            <template #mataKuliah=\"data\">\r\n              <td>{{ data.item.ampu?hexToUtf8(data.item.ampu.namaMatkul):'' }}</td>\r\n            </template>\r\n            <template #nilai=\"data\">\r\n              <td>{{ hexToUtf8(data.item.nilai) }}</td>\r\n            </template>\r\n            <template #timeUpdated=\"data\">\r\n              <td>{{ unixToDate(data.item.timeUpdated) }}</td>\r\n            </template>\r\n          </CDataTable>\r\n        </CCardBody>\r\n        <CCardFooter>\r\n          <CButton color=\"primary\" @click=\"goBack\">Back</CButton>\r\n        </CCardFooter>\r\n      </CCard>\r\n    </CCol>\r\n  </CRow>\r\n</template>\r\n\r\n<script>\r\nimport gql from \"graphql-tag\";\r\nimport CivitasHelper from \"@/contracts/CivitasHelper\";\r\n\r\nexport const GET_MAHASISWA = gql`\r\n  query mahasiswa($nim: ID!) {\r\n    mahasiswa(id: $nim) {\r\n      id\r\n      name\r\n      prodi\r\n      isLulus\r\n      isAssignedNINA\r\n      isUpdatedNINAData\r\n      linkedAccount {\r\n        id\r\n      }\r\n      timeCreated\r\n      lastUpdated\r\n    }\r\n  }\r\n`;\r\n\r\nexport const GET_STUDI = gql`\r\n  query riwayatStudis($nim: ID!) {\r\n    riwayatStudis(where: { nim: $nim }) {\r\n      id\r\n      ampu {\r\n        id\r\n        namaMatkul\r\n      }\r\n      nilai\r\n      timeUpdated\r\n    }\r\n  }\r\n`;\r\n\r\nconst ipfsClient = require(\"ipfs-http-client\");\r\nconst ipfs = ipfsClient({\r\n  host: \"ipfs.infura.io\",\r\n  port: 5001,\r\n  protocol: \"https\",\r\n});\r\n\r\nexport default {\r\n  name: \"InfoMahasiswa\",\r\n  beforeRouteEnter(to, from, next) {\r\n    next((vm) => {\r\n      vm.usersOpened = from.fullPath;\r\n    });\r\n  },\r\n  data() {\r\n    return {\r\n      usersOpened: null,\r\n      dataSubgraph: null,\r\n      mahasiswaData: {\r\n        nim: String(),\r\n        ipfsHash: String(),\r\n      },\r\n      mahasiswaIpfs: null,\r\n      dataContract: null,\r\n      dataIpfs: null,\r\n      previewImage: null,\r\n      riwayatStudis: null,\r\n    };\r\n  },\r\n  computed: {\r\n    fields() {\r\n      return [\r\n        {\r\n          key: \"key\",\r\n          label: \"Informasi\",\r\n          _classes: \"font-weight-bold text-capitalize\",\r\n          _style: \"width:25%\",\r\n        },\r\n        { key: \"value\", label: \"Nilai\" },\r\n      ];\r\n    },\r\n    studiFields() {\r\n      return [\r\n        {\r\n          key: \"id\",\r\n          _style: \"width:5%\",\r\n        },\r\n        { key: \"mataKuliah\" },\r\n        { key: \"nilai\", _style: \"width:5%\" },\r\n        { key: \"timeUpdated\" },\r\n      ];\r\n    },\r\n    mhsDataSubgraph() {\r\n      const mhsDetails = this.mahasiswa\r\n        ? Object.entries(this.mahasiswa)\r\n        : [[\"id\", \"Not found\"]];\r\n      return mhsDetails.map(([key, value]) => {\r\n        return { key, value };\r\n      });\r\n    },\r\n    mhsDataOnChain() {\r\n      const mhs = this.mahasiswaData\r\n        ? Object.entries(this.mahasiswaData)\r\n        : [[\"id\", \"Not found\"]];\r\n      return mhs.map(([key, value]) => {\r\n        return { key, value };\r\n      });\r\n    },\r\n    mhsDataIpfs() {\r\n      const mhsIpfs = this.mahasiswaIpfs\r\n        ? Object.entries(this.mahasiswaIpfs)\r\n        : [[\"id\", \"Not found\"]];\r\n      return mhsIpfs.map(([key, value]) => {\r\n        return { key, value };\r\n      });\r\n    },\r\n    visibleDataSubgraph() {\r\n      return this.mhsDataSubgraph.filter((param) => {\r\n        if (param.key == \"timeCreated\" || param.key == \"lastUpdated\") {\r\n          param.value = new Date(param.value * 1000);\r\n          return param;\r\n        }\r\n        if (web3.utils.isHexStrict(param.value)) {\r\n          param.value = web3.utils.hexToUtf8(param.value);\r\n        }\r\n        if (param.key == \"linkedAccount\") {\r\n          param.value = param.value ? param.value.id : \"Tidak Ada\";\r\n        }\r\n        if (param.value == null || param.key == \"__typename\") {\r\n          return null;\r\n        }\r\n        return param;\r\n      });\r\n    },\r\n  },\r\n  methods: {\r\n    goBack() {\r\n      this.$router.go(-1);\r\n    },\r\n    hexToUtf8(hex){\r\n      return web3.utils.hexToUtf8(hex)\r\n    },\r\n    unixToDate(unix){\r\n      const date = new Date(unix * 1000)\r\n      return date.toString();\r\n    }\r\n  },\r\n  beforeMount() {\r\n    let context = this;\r\n    web3.eth.getAccounts().then((accounts) => {\r\n      CivitasHelper.methods\r\n        .getNIMMahasiswa(accounts[0])\r\n        .call({ from: accounts[0] })\r\n        .then(function (result) {\r\n          if (result) {\r\n            context.$apollo\r\n              .query({\r\n                query: GET_MAHASISWA,\r\n                variables: {\r\n                  nim: result,\r\n                },\r\n              })\r\n              .then((response) => {\r\n                context.mahasiswa = response.data.mahasiswa;\r\n                context.dataSubgraph = context.visibleDataSubgraph;\r\n              });\r\n            CivitasHelper.methods\r\n              .getMahasiswa(result)\r\n              .call({ from: accounts[0] })\r\n              .then(function (result) {\r\n                if (result) {\r\n                  context.mahasiswaData.nim = web3.utils.hexToUtf8(result[0]);\r\n                  context.mahasiswaData.ipfsHash = web3.utils.hexToUtf8(\r\n                    result[1]\r\n                  );\r\n                  context.dataContract = context.mhsDataOnChain;\r\n                  ipfs\r\n                    .cat(\"/ipfs/\" + context.mahasiswaData.ipfsHash)\r\n                    .then((data) => {\r\n                      context.mahasiswaIpfs = JSON.parse(data.toString());\r\n                      context.dataIpfs = context.mhsDataIpfs;\r\n                      ipfs\r\n                        .cat(\"/ipfs/\" + context.mahasiswaIpfs.foto)\r\n                        .then((data) => {\r\n                          let blob = new Blob([data], { type: \"image/png\" });\r\n                          let url = URL.createObjectURL(blob);\r\n                          context.previewImage = url;\r\n                        });\r\n                    });\r\n                }\r\n              });\r\n            context.$apollo\r\n              .query({\r\n                query: GET_STUDI,\r\n                variables: {\r\n                  nim: result,\r\n                },\r\n              })\r\n              .then((response) => {\r\n                context.riwayatStudis = response.data.riwayatStudis;\r\n              });\r\n          }\r\n        });\r\n    });\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InfoMahasiswa.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InfoMahasiswa.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InfoMahasiswa.vue?vue&type=template&id=f1183f82&\"\nimport script from \"./InfoMahasiswa.vue?vue&type=script&lang=js&\"\nexport * from \"./InfoMahasiswa.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}