(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ad8171a"],{"144c":function(e,t,n){"use strict";var i=n("8792"),a="0x7CC6c878b1B06696Beb83d8F244C19d5C52a58D3",s=[{inputs:[{internalType:"uint256",name:"idCertificate",type:"uint256"},{internalType:"address",name:"assignedSigner",type:"address"},{internalType:"bytes9",name:"role",type:"bytes9"}],name:"assignSigner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"accountManagerAddress",type:"address"},{internalType:"address",name:"civitasHelperAddress",type:"address"},{internalType:"address",name:"akademikHelperAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"idCertificate",type:"uint256"},{indexed:!1,internalType:"address",name:"asignedSigner",type:"address"},{indexed:!1,internalType:"bytes9",name:"role",type:"bytes9"},{indexed:!1,internalType:"uint256",name:"timeAssigned",type:"uint256"}],name:"AssignSignerToCertificate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes12",name:"ownerNim",type:"bytes12"},{indexed:!1,internalType:"bytes16",name:"jenisSertifikat",type:"bytes16"},{indexed:!1,internalType:"uint8",name:"signedTimes",type:"uint8"},{indexed:!1,internalType:"uint8",name:"signRequired",type:"uint8"},{indexed:!1,internalType:"uint256",name:"timeCreated",type:"uint256"}],name:"CertificateCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timePublished",type:"uint256"}],name:"CertificatePublished",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"signer",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes9",name:"role",type:"bytes9"},{indexed:!1,internalType:"uint8",name:"signedTimes",type:"uint8"},{indexed:!1,internalType:"uint256",name:"timeSigned",type:"uint256"}],name:"CertificateSigned",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"signer",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timeSigned",type:"uint256"}],name:"CertificateSignedByOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes",name:"newIpfsHash",type:"bytes"},{indexed:!1,internalType:"bytes",name:"oldIpfsHash",type:"bytes"},{indexed:!1,internalType:"bool",name:"isUpdateNINAData",type:"bool"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"CertificateUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"riwayatId",type:"uint256"},{internalType:"uint256",name:"semesterId",type:"uint256"},{internalType:"uint256",name:"ampuId",type:"uint256"},{internalType:"uint256",name:"dosenId",type:"uint256"},{internalType:"bytes21",name:"dosenNip",type:"bytes21"},{internalType:"bytes2",name:"nilai",type:"bytes2"}],name:"changeNilaiRiwayatStudi",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"bytes12",name:"ownerNim",type:"bytes12"},{internalType:"bytes16",name:"jenisSertifikat",type:"bytes16"},{internalType:"uint8",name:"signRequired",type:"uint8"},{internalType:"bytes",name:"ipfsHash",type:"bytes"},{internalType:"address[]",name:"signerList",type:"address[]"},{internalType:"bytes9[]",name:"roleList",type:"bytes9[]"}],name:"createSertifikat",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes17",name:"noIjazah",type:"bytes17"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"IjazahDinomorkan",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"oldAddress",type:"address"},{indexed:!1,internalType:"address",name:"newAddress",type:"address"},{indexed:!1,internalType:"bytes2",name:"jenis",type:"bytes2"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"InterfaceUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"semesterId",type:"uint256"},{internalType:"uint256",name:"ampuId",type:"uint256"},{internalType:"uint256",name:"dosenId",type:"uint256"},{internalType:"bytes21",name:"dosenNip",type:"bytes21"},{internalType:"bytes12",name:"mahasiswaNim",type:"bytes12"},{internalType:"bytes2",name:"nilai",type:"bytes2"}],name:"pengisianNilaiMatkul",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes17",name:"noIjazah",type:"bytes17"}],name:"penomoranIjazah",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"}],name:"publishCertificate",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes12",name:"nim",type:"bytes12"},{indexed:!1,internalType:"uint256",name:"ampuId",type:"uint256"},{indexed:!1,internalType:"bytes2",name:"nilai",type:"bytes2"},{indexed:!1,internalType:"uint256",name:"timeCreated",type:"uint256"}],name:"RiwayatCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes2",name:"oldNilai",type:"bytes2"},{indexed:!1,internalType:"bytes2",name:"newNilai",type:"bytes2"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"RiwayatUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes9",name:"role",type:"bytes9"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"signCertificate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"signCertificateByOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAddress",type:"address"}],name:"updateAccountManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAddress",type:"address"}],name:"updateAkademikHelper",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"idCertificate",type:"uint256"},{internalType:"bytes",name:"newIpfsHash",type:"bytes"},{internalType:"bool",name:"isUpdateNINAData",type:"bool"}],name:"updateCertificateData",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAddress",type:"address"}],name:"updateCivitasHelper",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"}],name:"getCertificateOfOwner",outputs:[{internalType:"uint8",name:"",type:"uint8"},{internalType:"uint8",name:"",type:"uint8"},{internalType:"address",name:"",type:"address"},{internalType:"bytes16",name:"",type:"bytes16"},{internalType:"bytes",name:"",type:"bytes"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes9",name:"role",type:"bytes9"}],name:"getCertificateOfSigner",outputs:[{internalType:"uint8",name:"",type:"uint8"},{internalType:"uint8",name:"",type:"uint8"},{internalType:"address",name:"",type:"address"},{internalType:"bytes16",name:"",type:"bytes16"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"}],name:"getNomorIjazah",outputs:[{internalType:"bytes17",name:"",type:"bytes17"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"ipfsHash",type:"bytes"}],name:"getPublishedCertificate",outputs:[{internalType:"uint8",name:"",type:"uint8"},{internalType:"uint8",name:"",type:"uint8"},{internalType:"address",name:"",type:"address"},{internalType:"bytes16",name:"",type:"bytes16"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"riwayatId",type:"uint256"}],name:"getRiwayatStudi",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes2",name:"",type:"bytes2"},{internalType:"bytes12",name:"",type:"bytes12"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes9",name:"role",type:"bytes9"}],name:"getSignature",outputs:[{internalType:"bool",name:"",type:"bool"},{internalType:"bytes9",name:"",type:"bytes9"},{internalType:"address",name:"",type:"address"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes",name:"ownerSignature",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes9",name:"role",type:"bytes9"},{internalType:"bytes32",name:"hash",type:"bytes32"}],name:"verifyCertificate",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes32",name:"hash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"verifyCertificateOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"hash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"verifySignature",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"pure",type:"function"}],r=new i["a"].eth.Contract(s,a);t["a"]=r},"5a40":function(e,t,n){"use strict";n.r(t),n.d(t,"GET_SIGNATURE",(function(){return u}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"c-app d-flex align-items-top min-vh-100 pt-5"},[n("CContainer",{attrs:{fluid:""}},[n("CRow",{staticClass:"justify-content-center"},[n("CCol",{attrs:{md:"12"}},[n("CAlert",{attrs:{show:e.dismissFail,closeButton:"",color:"danger",fade:""},on:{"update:show":function(t){e.dismissFail=t}}},[e._v(e._s(e.dismissMsg))]),n("CCard",{staticClass:"mx-4 mb-0"},[n("CCardBody",{staticClass:"p-4"},[n("CForm",[n("h1",[e._v("Verifikasi Sertifikat")]),n("p",{staticClass:"text-muted"},[e._v("Verifikasi sertifikat dengan tanda tangan yang telah diberikan.")]),n("CRow",[n("CCol",{attrs:{sm:"8"}},[n("CInputFile",{attrs:{label:"Pilih File Sertifikat",placeholder:"Pilih File Sertifikat...",accept:e.documentFormat},on:{change:e.previewSertifikat}})],1),n("CCol",{attrs:{sm:"4"}},[e.fileHash?n("CButton",{attrs:{color:"success",href:e.fileUrl,target:"_blank"}},[e._v("Lihat")]):e._e()],1)],1),n("CInputFile",{attrs:{label:"Pilih File Signature Pemilik",placeholder:"Pilih File Owner Signature...",accept:e.signFormat},on:{change:e.previewSignOwner}}),n("CRow",{staticClass:"justify-content-center"},[e._l(e.signatures,(function(t,i){return[n("div",{key:i,staticClass:"d-flex",staticStyle:{width:"100%"}},[n("CContainer",{attrs:{fluid:""}},[n("CRow",{staticClass:"mx-auto"},[n("CCard",{staticStyle:{width:"100%"}},[n("CCardHeader",[e._v(" Signature #"+e._s(i+1)+" "),n("div",{staticClass:"card-header-actions"},[n("CLink",{staticClass:"card-header-action btn-close",attrs:{href:"#"},on:{click:function(t){return e.deleteSignature(i)}}},[n("CIcon",{attrs:{name:"cil-x-circle"}})],1)],1)]),n("CCardBody",[n("CForm",[n("CRow",{staticClass:"justify-content-center"},[n("CCol",{attrs:{sm:"8"}},[n("CInputFile",{attrs:{label:"Pilih File Signature",placeholder:"Pilih File Sertifikat...",accept:e.signFormat},on:{change:function(t){return e.previewSign(t,i)}}})],1),n("CCol",{attrs:{sm:"3"}},[e.isSignatureValid[i]&&e.isOwnerSignValid&&e.fileHash?n("CButton",{attrs:{color:"primary"},on:{click:function(t){return e.verifySigner(i)}}},[e._v("Verifikasi")]):e._e()],1)],1),n("CCol",[n("CInput",{attrs:{label:"Address Signer",value:e.recoveredSignAddress[i],disabled:""},on:{"update:value":function(t){return e.$set(e.recoveredSignAddress,i,t)}}}),e.subgraphSignData[i]?n("CInput",{attrs:{label:"ID Signature",value:e.subgraphSignData[i].id,disabled:""},on:{"update:value":function(t){return e.$set(e.subgraphSignData[i],"id",t)}}}):e._e(),n("CRow",[n("CCol",{attrs:{sm:"4"}},[e.subgraphSignData[i]?n("CInput",{attrs:{label:"Role",value:e.hexToString(e.subgraphSignData[i].role),disabled:""}}):e._e()],1),n("CCol",{attrs:{sm:"4"}},[e.subgraphSignData[i]?n("CInput",{attrs:{label:"Time Assigned",value:e.unixToDate(e.subgraphSignData[i].timeAssigned),disabled:""}}):e._e()],1),n("CCol",{attrs:{sm:"4"}},[e.subgraphSignData[i]?n("CInput",{attrs:{label:"Time Signed",value:e.unixToDate(e.subgraphSignData[i].timeSigned),disabled:""}}):e._e()],1)],1)],1)],1)],1)],1)],1)],1)],1)]}))],2),n("CButton",{attrs:{color:"success"},on:{click:e.addSignature}},[e._v("Tambah Signature")])],1)],1)],1)],1)],1)],1)],1)},a=[],s=n("9530"),r=n.n(s),p=n("144c");function d(){var e=y(["\n  query signature($id: ID!) {\n    signature(id: $id) {\n      id\n      idCertificate\n      signer\n      role\n      timeAssigned\n      timeSigned\n    }\n  }\n"]);return d=function(){return e},e}function y(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var u=r()(d()),l=n("94e4"),o=l({host:"ipfs.infura.io",port:5001,protocol:"https"}),m={name:"VerifikasiSertifikat",data:function(){return{fileHash:null,signatures:[],ownerSignature:{certificateId:null,sign:null},recoveredSignAddress:[],isOwnerSignValid:!1,isSignatureValid:[],dismissFail:0,dismissMsg:"",subgraphSignData:[]}},methods:{hexToString:function(e){return web3.utils.hexToUtf8(web3.utils.isHexStrict(e)?e:0)},unixToDate:function(e){var t=new Date(1e3*e);return t.toString()},previewSign:function(e,t){var n=this,i=new FileReader;i.addEventListener("load",(function(e){var i=JSON.parse(e.target.result);i.sign&&i.certificateId?(n.isSignatureValid[t]=!0,n.signatures[t]=i,n.$forceUpdate()):n.isSignatureValid[t]=!1,n.isSignatureValid[t]||(n.dismissMsg="Signature "+(t+1)+" Tidak Valid",n.dismissFail=5)})),i.readAsText(e[0])},previewSignOwner:function(e){var t=this,n=new FileReader;n.addEventListener("load",(function(e){var n=JSON.parse(e.target.result);n.sign&&n.certificateId?(t.isOwnerSignValid=!0,t.ownerSignature=n,t.$forceUpdate()):t.isOwnerSignValid=!1,t.isOwnerSignValid||(t.dismissMsg="Signature Owner Tidak Valid",t.dismissFail=5)})),n.readAsText(e[0])},previewSertifikat:function(e){var t=this;o.add(e[0]).then((function(e){t.fileHash=e[0].hash,t.$forceUpdate()}))},addSignature:function(){this.isSignatureValid.push(!1),this.recoveredSignAddress.push(null),this.subgraphSignData.push(null),this.signatures.push({certificateId:null,sign:null,role:null})},deleteSignature:function(e){this.isSignatureValid.splice(e,1),this.signatures.splice(e,1),this.recoveredSignAddress.splice(e,1),this.subgraphSignData.splice(e,1)},verifySigner:function(e){if(this.isDataReady(e)){var t=this.signatures[e],n=this.fileHash,i=this,a=this.ownerSignature;web3.eth.getAccounts().then((function(s){p["a"].methods.verifyCertificate(a.certificateId,a.sign,t.sign,t.role,web3.utils.sha3(n)).call({from:s[0]}).then((function(t){t&&(i.recoveredSignAddress[e]=t,i.$forceUpdate(),i.$apollo.query({query:u,variables:{id:web3.utils.toHex(a.certificateId)+"-"+i.recoveredSignAddress[e].toLowerCase()}}).then((function(t){i.subgraphSignData[e]=t.data.signature,i.$forceUpdate()})))}))}))}else console.log("data is not ready")},isDataReady:function(e){return!!(this.fileHash&&this.signatures[e].sign&&this.ownerSignature.sign)}},computed:{documentFormat:function(){return"application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.openxmlformats-officedocument.presentationml.slideshow"},signFormat:function(){return"application/json"},fileUrl:function(){var e="https://gateway.ipfs.io/ipfs/"+this.fileHash;return e}}},c=m,b=n("2877"),f=Object(b["a"])(c,i,a,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-7ad8171a.f1d45017.js.map