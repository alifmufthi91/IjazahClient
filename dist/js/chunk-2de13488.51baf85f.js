(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2de13488"],{"144c":function(e,t,n){"use strict";var i=n("8792"),a="0x7CC6c878b1B06696Beb83d8F244C19d5C52a58D3",s=[{inputs:[{internalType:"uint256",name:"idCertificate",type:"uint256"},{internalType:"address",name:"assignedSigner",type:"address"},{internalType:"bytes9",name:"role",type:"bytes9"}],name:"assignSigner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"accountManagerAddress",type:"address"},{internalType:"address",name:"civitasHelperAddress",type:"address"},{internalType:"address",name:"akademikHelperAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"idCertificate",type:"uint256"},{indexed:!1,internalType:"address",name:"asignedSigner",type:"address"},{indexed:!1,internalType:"bytes9",name:"role",type:"bytes9"},{indexed:!1,internalType:"uint256",name:"timeAssigned",type:"uint256"}],name:"AssignSignerToCertificate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes12",name:"ownerNim",type:"bytes12"},{indexed:!1,internalType:"bytes16",name:"jenisSertifikat",type:"bytes16"},{indexed:!1,internalType:"uint8",name:"signedTimes",type:"uint8"},{indexed:!1,internalType:"uint8",name:"signRequired",type:"uint8"},{indexed:!1,internalType:"uint256",name:"timeCreated",type:"uint256"}],name:"CertificateCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timePublished",type:"uint256"}],name:"CertificatePublished",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"signer",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes9",name:"role",type:"bytes9"},{indexed:!1,internalType:"uint8",name:"signedTimes",type:"uint8"},{indexed:!1,internalType:"uint256",name:"timeSigned",type:"uint256"}],name:"CertificateSigned",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"signer",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timeSigned",type:"uint256"}],name:"CertificateSignedByOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes",name:"newIpfsHash",type:"bytes"},{indexed:!1,internalType:"bytes",name:"oldIpfsHash",type:"bytes"},{indexed:!1,internalType:"bool",name:"isUpdateNINAData",type:"bool"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"CertificateUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"riwayatId",type:"uint256"},{internalType:"uint256",name:"semesterId",type:"uint256"},{internalType:"uint256",name:"ampuId",type:"uint256"},{internalType:"uint256",name:"dosenId",type:"uint256"},{internalType:"bytes21",name:"dosenNip",type:"bytes21"},{internalType:"bytes2",name:"nilai",type:"bytes2"}],name:"changeNilaiRiwayatStudi",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"bytes12",name:"ownerNim",type:"bytes12"},{internalType:"bytes16",name:"jenisSertifikat",type:"bytes16"},{internalType:"uint8",name:"signRequired",type:"uint8"},{internalType:"bytes",name:"ipfsHash",type:"bytes"},{internalType:"address[]",name:"signerList",type:"address[]"},{internalType:"bytes9[]",name:"roleList",type:"bytes9[]"}],name:"createSertifikat",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes17",name:"noIjazah",type:"bytes17"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"IjazahDinomorkan",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"oldAddress",type:"address"},{indexed:!1,internalType:"address",name:"newAddress",type:"address"},{indexed:!1,internalType:"bytes2",name:"jenis",type:"bytes2"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"InterfaceUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"semesterId",type:"uint256"},{internalType:"uint256",name:"ampuId",type:"uint256"},{internalType:"uint256",name:"dosenId",type:"uint256"},{internalType:"bytes21",name:"dosenNip",type:"bytes21"},{internalType:"bytes12",name:"mahasiswaNim",type:"bytes12"},{internalType:"bytes2",name:"nilai",type:"bytes2"}],name:"pengisianNilaiMatkul",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes17",name:"noIjazah",type:"bytes17"}],name:"penomoranIjazah",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"}],name:"publishCertificate",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes12",name:"nim",type:"bytes12"},{indexed:!1,internalType:"uint256",name:"ampuId",type:"uint256"},{indexed:!1,internalType:"bytes2",name:"nilai",type:"bytes2"},{indexed:!1,internalType:"uint256",name:"timeCreated",type:"uint256"}],name:"RiwayatCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"ID",type:"uint256"},{indexed:!1,internalType:"bytes2",name:"oldNilai",type:"bytes2"},{indexed:!1,internalType:"bytes2",name:"newNilai",type:"bytes2"},{indexed:!1,internalType:"uint256",name:"timeUpdated",type:"uint256"}],name:"RiwayatUpdated",type:"event"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes9",name:"role",type:"bytes9"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"signCertificate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"signCertificateByOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAddress",type:"address"}],name:"updateAccountManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAddress",type:"address"}],name:"updateAkademikHelper",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"idCertificate",type:"uint256"},{internalType:"bytes",name:"newIpfsHash",type:"bytes"},{internalType:"bool",name:"isUpdateNINAData",type:"bool"}],name:"updateCertificateData",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newAddress",type:"address"}],name:"updateCivitasHelper",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"}],name:"getCertificateOfOwner",outputs:[{internalType:"uint8",name:"",type:"uint8"},{internalType:"uint8",name:"",type:"uint8"},{internalType:"address",name:"",type:"address"},{internalType:"bytes16",name:"",type:"bytes16"},{internalType:"bytes",name:"",type:"bytes"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes9",name:"role",type:"bytes9"}],name:"getCertificateOfSigner",outputs:[{internalType:"uint8",name:"",type:"uint8"},{internalType:"uint8",name:"",type:"uint8"},{internalType:"address",name:"",type:"address"},{internalType:"bytes16",name:"",type:"bytes16"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"}],name:"getNomorIjazah",outputs:[{internalType:"bytes17",name:"",type:"bytes17"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"ipfsHash",type:"bytes"}],name:"getPublishedCertificate",outputs:[{internalType:"uint8",name:"",type:"uint8"},{internalType:"uint8",name:"",type:"uint8"},{internalType:"address",name:"",type:"address"},{internalType:"bytes16",name:"",type:"bytes16"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"riwayatId",type:"uint256"}],name:"getRiwayatStudi",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes2",name:"",type:"bytes2"},{internalType:"bytes12",name:"",type:"bytes12"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes9",name:"role",type:"bytes9"}],name:"getSignature",outputs:[{internalType:"bool",name:"",type:"bool"},{internalType:"bytes9",name:"",type:"bytes9"},{internalType:"address",name:"",type:"address"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes",name:"ownerSignature",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes9",name:"role",type:"bytes9"},{internalType:"bytes32",name:"hash",type:"bytes32"}],name:"verifyCertificate",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"certificateId",type:"uint256"},{internalType:"bytes32",name:"hash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"verifyCertificateOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"hash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"verifySignature",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"pure",type:"function"}],r=new i["a"].eth.Contract(s,a);t["a"]=r},fa91:function(e,t,n){"use strict";n.r(t),n.d(t,"GET_SIGNATURES",(function(){return o}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("CRow",[n("CCol",{attrs:{col:"12",xl:"12"}},[n("CCard",[n("CCardHeader",[e._v("Daftar Tanda Tangan Pribadi")]),n("CCardBody",[n("CDataTable",{attrs:{hover:"",items:e.signatures,fields:e.fields,"items-per-page":5,"active-page":e.activePage,pagination:{doubleArrows:!1,align:"center"},sorter:""},on:{"page-change":e.pageChange},scopedSlots:e._u([{key:"role",fn:function(t){return[n("td",[e._v(e._s(e.hexToString(t.item.role)))])]}},{key:"timeAssigned",fn:function(t){return[n("td",[e._v(e._s(e.unixToDate(t.item.timeAssigned)))])]}},{key:"status",fn:function(t){return[n("td",[n("CBadge",{attrs:{color:t.item.timeSigned?"success":"danger"}},[e._v(e._s(t.item.timeSigned?"Sudah":"Belum"))])],1)]}},{key:"timeSigned",fn:function(t){return[n("td",[e._v(e._s(t.item.timeSigned?e.unixToDate(t.item.timeSigned):"not signed yet"))])]}},{key:"action",fn:function(t){return[n("td",[n("CCol",{staticClass:"mb-3 mb-xl-0 text-center"},[n("CButtonGroup",[t.item.timeSigned?e._e():n("CButton",{attrs:{color:"success",size:"sm"},on:{click:function(n){return e.openSignModal(t.item.idCertificate,t.item.role)}}},[e._v("Tanda Tangan")])],1)],1)],1)]}}])})],1)],1)],1),n("CModal",{attrs:{show:e.signModal,"no-close-on-backdrop":!0,centered:!0,title:"Tanda Tangani Sertifikat",md:"8",color:"success"},on:{"update:show":function(t){e.signModal=t}},scopedSlots:e._u([{key:"header",fn:function(){return[n("h6",{staticClass:"modal-title"},[e._v("Publish Sertifikat")]),n("CButtonClose",{staticClass:"text-white",on:{click:function(t){e.signModal=!1}}})]},proxy:!0},{key:"footer",fn:function(){return[n("CButton",{attrs:{color:"danger"},on:{click:function(t){return e.confirmSign(!1)}}},[e._v("Kembali")]),e.signData.signature?e._e():n("CButton",{attrs:{disabled:"",color:"success"}},[e._v("Konfirmasi")]),e.signData.signature?n("CButton",{attrs:{color:"success"},on:{click:function(t){return e.confirmSign(!0)}}},[e._v("Konfirmasi")]):e._e()]},proxy:!0}])},[n("CRow",{staticClass:"justify-content-center"},[n("CCol",[n("CInput",{attrs:{label:"IPFS Hash",readonly:"",value:e.sertifikatIpfs},on:{"update:value":function(t){e.sertifikatIpfs=t}}}),!e.signData.messageHash&&e.sertifikatIpfs?n("CButton",{staticClass:"mr-3",attrs:{color:"info"},on:{click:e.signMessage}},[e._v("Tanda Tangani")]):e._e(),e.sertifikatIpfs?n("CButton",{attrs:{color:"success",href:e.downloadUrl,target:"_blank"}},[e._v("Download Sertifikat")]):e._e(),e.signData.messageHash?n("CInput",{attrs:{label:"Message Hash",readonly:"",value:e.signData.messageHash},on:{"update:value":function(t){return e.$set(e.signData,"messageHash",t)}}}):e._e(),e.signData.signature?n("CInput",{attrs:{label:"Signature",readonly:"",value:e.signData.signature},on:{"update:value":function(t){return e.$set(e.signData,"signature",t)}}}):e._e()],1)],1)],1)],1)},a=[],s=n("9530"),r=n.n(s),y=n("144c");function p(){var e=d(["\n  query signatures($id: ID!) {\n    signatures(where: { signer: $id }) {\n      id\n      idCertificate\n      signer\n      role\n      timeAssigned\n      timeSigned\n    }\n  }\n"]);return p=function(){return e},e}function d(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var u=n("94e4"),l=u({host:"ipfs.infura.io",port:5001,protocol:"https"}),o=r()(p()),m={name:"InfoSignatureCivitas",data:function(){return{signatures:null,fields:[{key:"idCertificate",_style:"width:5%"},{key:"role"},{key:"timeAssigned"},{key:"status"},{key:"timeSigned"},{key:"action",label:"Aksi",sorter:!1,filter:!1}],activePage:1,selectedSertifikat:null,selectedRole:null,sertifikatIpfs:null,signData:{messageHash:null,signature:null},signModal:!1}},watch:{$route:{immediate:!0,handler:function(e){e.query&&e.query.page&&(this.activePage=Number(e.query.page))}}},mounted:function(){var e=this;web3.eth.getAccounts().then((function(t){e.$apollo.query({query:o,variables:{id:t[0]}}).then((function(t){e.signatures=t.data.signatures}))}))},computed:{downloadUrl:function(){return"https://gateway.ipfs.io/ipfs/"+this.sertifikatIpfs}},methods:{pageChange:function(e){this.$router.push({query:{page:e}})},detailClicked:function(e){this.$router.push({path:"signature/detail/"+"".concat(e.id)})},hexToString:function(e){if(web3.utils.isHexStrict(e))return web3.utils.hexToUtf8(e)},unixToDate:function(e){var t=new Date(1e3*e);return t.toString()},signMessage:function(){var e=this.sertifikatIpfs,t=web3.utils.sha3(e),n=this.signData;web3.eth.getAccounts().then((function(e){web3.eth.personal.sign(t,e[0]).then((function(e){n.messageHash=t,n.signature=e}))}))},signCertificate:function(){var e=this.selectedSertifikat,t=this.signData.signature,n=this.selectedRole;e&&t&&web3.eth.getAccounts().then((function(i){y["a"].methods.signCertificate(e,n,t).send({from:i[0]}).on("error",(function(e,t){console.log(e)})).on("transactionHash",(function(e){console.log(e)}))}))},openSignModal:function(e,t){this.signData.messageHash=null,this.signData.signature=null,this.sertifikatIpfs=null,this.getSertifikatHash(e,t),this.signModal=!0,this.selectedRole=t,this.selectedSertifikat=e},confirmSign:function(e){this.signModal=!1,e&&this.signCertificate()},getSertifikatHash:function(e,t){var n=this;web3.eth.getAccounts().then((function(i){y["a"].methods.getCertificateOfSigner(e,t).call({from:i[0]}).then((function(e){l.cat("/ipfs/"+web3.utils.hexToUtf8(e[4])).then((function(e){var t=JSON.parse(e.toString());n.sertifikatIpfs=t.file}))}))}))}}},c=m,f=n("2877"),b=Object(f["a"])(c,i,a,!1,null,null,null);t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-2de13488.51baf85f.js.map