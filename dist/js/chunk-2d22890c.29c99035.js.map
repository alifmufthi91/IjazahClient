{"version":3,"sources":["webpack:///./src/views/civitas/InfoCivitas.vue?8793","webpack:///src/views/civitas/InfoCivitas.vue","webpack:///./src/views/civitas/InfoCivitas.vue?52bc","webpack:///./src/views/civitas/InfoCivitas.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","dataContract","fields","dataSubgraph","dataIpfs","staticClass","previewImage","_e","staticStyle","on","goBack","staticRenderFns","host","port","protocol","name","beforeRouteEnter","next","vm","usersOpened","from","fullPath","data","civitasData","nip","String","ipfsHash","civitasIpfs","computed","cvtDataSubgraph","cvtDetails","map","cvtDataOnChain","cvt","cvtDataIpfs","cvtIpfs","visibleDataSubgraph","filter","param","key","value","Date","web3","utils","isHexStrict","hexToUtf8","id","methods","$router","go","beforeMount","eth","getAccounts","then","CivitasHelper","component"],"mappings":"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","file":"js/chunk-2d22890c.29c99035.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CRow',[_c('CCol',{attrs:{\"col\":\"12\"}},[_c('CCard',[_c('CCardHeader',[_vm._v(\"Informasi Civitas Akademika\")]),_c('CCardBody',[_c('h5',[_vm._v(\"Data On-Chain\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.dataContract,\"fields\":_vm.fields}}),_c('h5',[_vm._v(\"Data Off-Chain (Subgraph)\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.dataSubgraph,\"fields\":_vm.fields}}),_c('h5',[_vm._v(\"Data Off-Chain (IPFS)\")]),_c('CDataTable',{attrs:{\"striped\":\"\",\"small\":\"\",\"fixed\":\"\",\"items\":_vm.dataIpfs,\"fields\":_vm.fields}}),_c('CRow',{staticClass:\"justify-content-center\"},[_c('CCol',{attrs:{\"sm\":\"3\"}},[_c('CCard',[_c('CCardBody',[(!_vm.previewImage)?_c('div',[_c('CProgress',{staticClass:\"mt-1\",staticStyle:{\"height\":\"20px\"},attrs:{\"color\":\"success\",\"value\":100,\"animated\":\"\"}})],1):_vm._e(),(_vm.previewImage)?_c('div',[_c('img',{staticClass:\"d-block w-100 h-100 img-fluid\",attrs:{\"src\":_vm.previewImage}})]):_vm._e()])],1)],1)],1)],1),_c('CCardFooter',[_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.goBack}},[_vm._v(\"Back\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <CRow>\r\n    <CCol col=\"12\">\r\n      <CCard>\r\n        <CCardHeader>Informasi Civitas Akademika</CCardHeader>\r\n        <CCardBody>\r\n          <h5>Data On-Chain</h5>\r\n          <CDataTable striped small fixed :items=\"dataContract\" :fields=\"fields\" />\r\n          <h5>Data Off-Chain (Subgraph)</h5>\r\n          <CDataTable striped small fixed :items=\"dataSubgraph\" :fields=\"fields\" />\r\n          <h5>Data Off-Chain (IPFS)</h5>\r\n          <CDataTable striped small fixed :items=\"dataIpfs\" :fields=\"fields\" />\r\n          <CRow class=\"justify-content-center\">\r\n            <CCol sm=\"3\">\r\n              <CCard>\r\n                <CCardBody>\r\n                  <div v-if=\"!previewImage\">\r\n                    <CProgress\r\n                      color=\"success\"\r\n                      :value=\"100\"\r\n                      animated\r\n                      style=\"height:20px;\"\r\n                      class=\"mt-1\"\r\n                    />\r\n                  </div>\r\n                  <div v-if=\"previewImage\">\r\n                    <img class=\"d-block w-100 h-100 img-fluid\" :src=\"previewImage\" />\r\n                  </div>\r\n                </CCardBody>\r\n              </CCard>\r\n            </CCol>\r\n          </CRow>\r\n        </CCardBody>\r\n        <CCardFooter>\r\n          <CButton color=\"primary\" @click=\"goBack\">Back</CButton>\r\n        </CCardFooter>\r\n      </CCard>\r\n    </CCol>\r\n  </CRow>\r\n</template>\r\n\r\n<script>\r\nimport gql from \"graphql-tag\";\r\nimport CivitasHelper from \"@/contracts/CivitasHelper\";\r\n\r\nexport const GET_CIVITAS = gql`\r\n  query civita($nip: ID!) {\r\n    civita(id: $nip) {\r\n      id\r\n      name\r\n      role\r\n      linkedAccount {\r\n        id\r\n      }\r\n      timeCreated\r\n      lastUpdated\r\n    }\r\n  }\r\n`;\r\n\r\nconst ipfsClient = require(\"ipfs-http-client\");\r\nconst ipfs = ipfsClient({\r\n  host: \"ipfs.infura.io\",\r\n  port: 5001,\r\n  protocol: \"https\",\r\n});\r\n\r\nexport default {\r\n  name: \"InfoCivitas\",\r\n  beforeRouteEnter(to, from, next) {\r\n    next((vm) => {\r\n      vm.usersOpened = from.fullPath;\r\n    });\r\n  },\r\n  data() {\r\n    return {\r\n      usersOpened: null,\r\n      dataSubgraph: null,\r\n      civitasData: {\r\n        nip: String(),\r\n        ipfsHash: String(),\r\n      },\r\n      civitasIpfs: null,\r\n      dataContract: null,\r\n      dataIpfs: null,\r\n      previewImage: null,\r\n    };\r\n  },\r\n  computed: {\r\n    fields() {\r\n      return [\r\n        {\r\n          key: \"key\",\r\n          label: \"Informasi\",\r\n          _classes: \"font-weight-bold text-capitalize\",\r\n          _style: \"width:25%\",\r\n        },\r\n        { key: \"value\", label: \"Nilai\" },\r\n      ];\r\n    },\r\n    cvtDataSubgraph() {\r\n      const cvtDetails = this.civita\r\n        ? Object.entries(this.civita)\r\n        : [[\"id\", \"Not found\"]];\r\n      return cvtDetails.map(([key, value]) => {\r\n        return { key, value };\r\n      });\r\n    },\r\n    cvtDataOnChain() {\r\n      const cvt = this.civitasData\r\n        ? Object.entries(this.civitasData)\r\n        : [[\"id\", \"Not found\"]];\r\n      return cvt.map(([key, value]) => {\r\n        return { key, value };\r\n      });\r\n    },\r\n    cvtDataIpfs() {\r\n      const cvtIpfs = this.civitasIpfs\r\n        ? Object.entries(this.civitasIpfs)\r\n        : [[\"id\", \"Not found\"]];\r\n      return cvtIpfs.map(([key, value]) => {\r\n        return { key, value };\r\n      });\r\n    },\r\n    visibleDataSubgraph() {\r\n      return this.cvtDataSubgraph.filter((param) => {\r\n        if (param.key == \"timeCreated\" || param.key == \"lastUpdated\") {\r\n          param.value = new Date(param.value * 1000);\r\n          return param;\r\n        }\r\n        if (web3.utils.isHexStrict(param.value)) {\r\n          param.value = web3.utils.hexToUtf8(param.value);\r\n        }\r\n        if (param.key == \"linkedAccount\") {\r\n          param.value = param.value ? param.value.id : \"Tidak Ada\";\r\n        }\r\n        if (param.value == null || param.key == \"__typename\") {\r\n          return null;\r\n        }\r\n        return param;\r\n      });\r\n    },\r\n  },\r\n  methods: {\r\n    goBack() {\r\n      this.$router.go(-1);\r\n    },\r\n  },\r\n  beforeMount() {\r\n    let context = this;\r\n    web3.eth.getAccounts().then((accounts) => {\r\n      CivitasHelper.methods\r\n        .getNIPCivitas(accounts[0])\r\n        .call({ from: accounts[0] })\r\n        .then(function (result) {\r\n          if (result) {\r\n            web3.eth.getAccounts().then((accounts) => {\r\n              CivitasHelper.methods\r\n                .getCivitas(result)\r\n                .call({ from: accounts[0] })\r\n                .then(function (result) {\r\n                  if (result) {\r\n                    context.civitasData.nip = web3.utils.hexToUtf8(result[0]);\r\n                    context.civitasData.ipfsHash = web3.utils.hexToUtf8(\r\n                      result[1]\r\n                    );\r\n                    context.dataContract = context.cvtDataOnChain;\r\n                    ipfs\r\n                      .cat(\"/ipfs/\" + context.civitasData.ipfsHash)\r\n                      .then((data) => {\r\n                        context.civitasIpfs = JSON.parse(data.toString());\r\n                        context.dataIpfs = context.cvtDataIpfs;\r\n                        ipfs\r\n                          .cat(\"/ipfs/\" + context.civitasIpfs.foto)\r\n                          .then((data) => {\r\n                            let blob = new Blob([data], { type: \"image/png\" });\r\n                            let url = URL.createObjectURL(blob);\r\n                            context.previewImage = url;\r\n                          });\r\n                      });\r\n                  }\r\n                });\r\n            });\r\n            context.$apollo\r\n              .query({\r\n                query: GET_CIVITAS,\r\n                variables: {\r\n                  nip: result,\r\n                },\r\n              })\r\n              .then((response) => {\r\n                context.civita = response.data.civita;\r\n                context.dataSubgraph = context.visibleDataSubgraph;\r\n              });\r\n          }\r\n        });\r\n    });\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InfoCivitas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InfoCivitas.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InfoCivitas.vue?vue&type=template&id=55fbf9dd&\"\nimport script from \"./InfoCivitas.vue?vue&type=script&lang=js&\"\nexport * from \"./InfoCivitas.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}